#INCLUDE "FIVEWIN.CH"
/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณVLOCALSD1 บAutor  ณ                    บ Data ณ  06/09/06   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณValida local de Entrada da Nota Fiscal todas as NF          บฑฑ
ฑฑบ          ณdevem entrar como local 01 em funcao das nossas             บฑฑ
ฑฑบ          ณcustomizacoes.                                              บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณMultitek                                                    บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
User Function MT100TOK()                                                      
Local lRet  := .T.
Local nY    := 0
Local nLocal:= aScan(aHeader,{|x| AllTrim(x[2])=="D1_LOCAL"})
Local nCod  := aScan(aHeader,{|x| AllTrim(x[2])=="D1_COD"})

For nY := 1 to Len(acols)
	
	If !aCols[nY][Len(aHeader)+1]
		
		IF  ! SUBSTR(aCols[nY][nCod],1,2) $ "PS|MC|AF"
			
			If aCols[nY][nLocal]<>'01'
				Aviso("ATENCAO", "O Local de entrada do material deve ser sempre 01 ",{"&Ok"})
				lRet := .f.
			Endif
			
		Endif
		
	Endif
	
Next

Return(lRet)

