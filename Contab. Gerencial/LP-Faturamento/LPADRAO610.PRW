User Function LPADRA610(cLanc) 

//
// Importante como a contabilizacao do custo poderia ocorrer tambem pelo 610 e como os CF utilizados devem ser os mesmos optei
// em deixar nesta mesma rotina a contabilizacao do 678-001.
//

Local nReturn:=0

//7102  retirado para teste

If cLanc $ "610-01"
   If SD2->D2_TIPO$"N/C"    // Contabilizacao do Valor Total da Venda alterado nasser 16/02/07
      nReturn:=IIF(TRIM(SD2->D2_CF)$"5102/6102/5110/6110/5106/6106/5119/6119/5123/5403/6403/6123/5655/6655/5656/6656/5112/6112/5117/6117/5108/6108/5114/5405/6114/6405/5111/6111/5654/6654/5656/6656/5112/6112".AND. SD2->D2_TIPO$"N/C",SD2->D2_TOTAL+SD2->D2_VALIPI,0) 
   ElseIf  SD2->D2_TIPO$"P" // Contabilizacao da Venda (Complemento de Ipi)
      nReturn:=IIF(TRIM(SD2->D2_CF)$"5102/6102/5110/6110/5106/6106/5119/6119/5123/5403/6403/6123/5655/6655/5656/6656/5112/6112/5117/6117/5108/6108/5114/5405/6114/6405/5111/6111/5654/6654/5656/6656/5112/6112".AND. SD2->D2_TIPO$"P",SD2->D2_VALIPI,0) 
   Endif
ElseIf cLanc $ "610-02"     // Contabilizacao do Ipi ALTERADO BURIN 21/02/07 5111/61111
   nReturn:=IIF(TRIM(SD2->D2_CF)$"5102/6102/5110/6110/5106/6106/5119/6119/5123/5403/6403/6123/5655/6655/5656/6656/5112/6112/5117/6117/5108/6108/5114/5405/6114/6405/7102/5111/6111/5654/6654/5656/6656/5112/6112".AND. SD2->D2_TIPO$"N/C/P",SD2->D2_VALIPI,0)    
ElseIf cLanc $ "610-03"     // Contabilizacao do Icm ALTERADO BURIN 21/02/07 5111/61111
   nReturn:=IIF(TRIM(SD2->D2_CF)$"5102/6102/5110/6110/5106/6106/5119/6119/5123/5403/6403/6123/5655/6655/5656/6656/5112/6112/5117/6117/5108/6108/5114/5405/6114/6405/7102/5111/6111/5654/6654/5656/6656/5112/6112".AND. SD2->D2_TIPO$"N/C/I",SD2->D2_VALICM,0)   
ElseIf cLanc $ "610-04"     // Contabilizacao ALTERADO BURIN 21/02/07 5111/61111
   nReturn:=IIF(TRIM(SD2->D2_CF)$"5102/6102/5110/6110/5106/6106/5119/6119/5123/5403/6403/6123/5655/6655/5656/6656/5112/6112/5117/6117/5108/6108/5114/5405/6114/6405/7102/5111/6111/5654/6654/5656/6656/5112/6112".AND. SD2->D2_TIPO$"N/C",SD2->D2_VALIMP6,0) 
ElseIf cLanc $ "610-05"    // ALTERADO BURIN 21/02/07 5111/61111
   nReturn:=IIF(TRIM(SD2->D2_CF)$"5102/6102/5110/6110/5106/6106/5119/6119/5123/5403/6403/6123/5655/6655/5656/6656/5112/6112/5117/6117/5108/6108/5114/5405/6114/6405/7102/5111/6111/5654/6654/5656/6656/5112/6112".AND. SD2->D2_TIPO$"N/C",SD2->D2_VALIMP5,0)     
Elseif cLanc $ "678-01"     // Contabilizacao do Custo do Produto Vendido.
   nReturn:=IIF(TRIM(SD2->D2_CF)$"5102/6102/5110/6110/5106/6106/5119/6119/5123/6123/5655/6655/5656/6656/5112/6112/5117/6117/5108/6108/5114/5403/5405/6114/6403/6405/7102/5111/6111/5654/6654/5656/6656/5112/6112".AND. SD2->D2_TIPO$"N/C/P",SD2->D2_CUSTO1,0) 
Endif

Return(nReturn)



